From 6a62efbebcdf17e3af57f04603aa5f0d61b0c1e2 Mon Sep 17 00:00:00 2001
From: Scott Murray <scott.murray@konsulko.com>
Date: Wed, 27 Jul 2022 18:23:32 -0400
Subject: [PATCH] Add app-id command-line argument

Add a command-line argument for specifying the app id, so that basic
applications do not need to supply a full JSON configuration just to
do so.

Signed-off-by: Scott Murray <scott.murray@konsulko.com>
---
 shell/main.cc | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/shell/main.cc b/shell/main.cc
index 6fdd907..662b7d1 100644
--- a/shell/main.cc
+++ b/shell/main.cc
@@ -151,6 +151,16 @@ int main(int argc, char** argv) {
       FML_DLOG(INFO) << "Cursor Theme: " << config.cursor_theme;
       RemoveArgument(config.view.vm_args, "--t=" + config.cursor_theme);
     }
+    if (cl.HasOption("app-id")) {
+      cl.GetOptionValue("app-id", &config.app_id);
+      if (config.app_id.empty()) {
+        FML_LOG(ERROR)
+            << "--app-id option requires an argument (e.g. --app-id=gallery)";
+        return EXIT_FAILURE;
+      }
+      FML_DLOG(INFO) << "Application ID: " << config.app_id;
+      RemoveArgument(config.view.vm_args, "--app-id=" + config.app_id);
+    }
   }
 
   auto vm_arg_count = config.view.vm_args.size();
-- 
2.35.3

